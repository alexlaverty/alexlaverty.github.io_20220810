var AddPerson=function(e){"use strict";var a=function(a){var d=[],s=new e.Deferred;return AddPerson.cacheLoaded?s.resolve(!0):(e(".add-person-css").remove(),e.each(a.css,function(a,d){e("head").append('<link class="add-person-css" rel="stylesheet" href="'+d+'" type="text/css" />')}),e.each(a.js,function(a,o){var n=new e.Deferred;e.ajax({dataType:"script",cache:!0,url:o,crossDomain:!0,success:function(){n.resolve(!0)},failure:function(){s.reject(o)}}),d.push(n)}),e.when.apply(e,d).done(function(){s.resolve(!0)})),s};return{cacheLoaded:!1,apmDefCallback:function(e){"m"===e.mode?ui.modal.close():window.isCancelClicked||location.reload()},apsCallback:function(a){if(null!==a.newPid&&null!==a.status)if("success"===a.status){if(e("#tabContentHints").hasClass("tabActive")){var d="family",s=a.newPid,o=d.concat(s),n=e("#personPageHints #"+o);if(n.length){var i=n.find(".userCardImg");if(n.find(".userCardTitle").text(a.fullName).end().find(".userCardSubTitle").html(a.lifeRange),i.hasClass("icon")){var l;switch(a.gender){case"F":l="iconFemale";break;case"M":l="iconMale";break;default:l="iconPerson"}i.hasClass(l)||i.removeClass("iconFemale iconMale iconPerson").addClass(l)}}}window.personScreenType("smart-phone")?window.glue.reload({responsiveTab:"family"},window.glue.reloaded):window.glue.reload(window.glue.reloaded),null!==acom&&null!==acom.bus&&acom.bus.emit("AddPerson::Notify::Success",a.message,a.title,!0)}else"failure"===a.status&&null!==acom&&null!==acom.bus&&acom.bus.emit("AddPerson::Notify::Failure",a.message,a.title);return"function"==typeof AddPerson.apmCallback?AddPerson.apmCallback(a):AddPerson.apmDefCallback(a)},Modal:function(d,s,o,n,i,l){var r=addPersonUrl+"/modals/addPerson/tree/"+d+"/person/"+s;"edit"===i&&(r+="/edit");var t={};"object"==typeof o?t=o:"string"==typeof o&&(t=JSON.parse(o)),t.useNewVersion="5",t.isPageVersion=!1;var c={showLoading:!0,hideCloseBtn:!1,useCustomPadding:!0,closeOnBkgClick:!0,closeOnEscape:!0,isMarketing:!1,width:800,onOpen:function(i){closeCallouts();var l=i;e.ajax({url:r,xhrFields:{withCredentials:!0},crossDomain:!0,cache:!1,timeout:15e3,type:"GET",data:t,dataType:"jsonp",contentType:"application/json",success:function(r){if(r.hasexception){var t='<div class="ancGrid ancGridPadded"><div class="ancCol w100"><p class="icon iconWarning">'+PersonCard.text.addPersonErrorText+"</p></div></div>";l=e(l.element),ui.modal.showLoading(!1),l.html(t)}else e.when(a(r)).done(function(){if(AddPerson.cacheLoaded=!0,l=e(l.element),ui.modal.showLoading(!1),r.name){var a=r.imageUrl?'<div class="userCardImg userCardImgSquare"><img alt="'+r.title+'" src="'+r.imageUrl+'" style="vertical-align:middle;"></div>':'<div class="userCardImg userCardImgSquare icon icon'+r.gender+'" role="presentation"></div>',i=r.dateRange?'<p class="userCardSubTitle noTopSpacing" style="font-weight:normal;">'+r.dateRange+"</p>":"";l.html('<div class="modalHasTitle"><div class="modalHeader modalHeaderUserCard"  id="addPersonModalHeader"><div class="ancGrid full480"><div class="ancCol"><h4 class="modalTitle" style="margin:4px 0;">'+r.title+'</h4></div><div class="ancCol ancColUserCard hide480"><div class="userCard userCardSize2">'+a+'<div class="userCardContent"><h5 class="userCardTitle">'+r.name+"</h5>"+i+"</div></div></div></div></div>"+r.html+"</div>")}else l.html('<div class="modalHasTitle"><div class="modalHeader"><h4 class="modalTitle">'+r.title+"</h4></div>"+r.html+"</div>");if(AddPerson.apmCallback=void 0!==n?n:AddPerson.apmDefCallback,"function"==typeof window.AddPersonModalInit){$Ap&&($Ap.APMAutoCompleteDates=window.PersonCard.autoCompleteDates),new window.AddPersonModalInit(d,s,o.history,AddPerson.apsCallback,"m");var t=document.querySelector("#modal .modalClose");t&&window.personAnalyticsTrackClickV2&&t.addEventListener("click",function(){window.personAnalyticsTrackClick("QuickEditCancelorClose")},!1)}}).fail(function(e){i.html(r.html),window&&window.console&&console.error("AddPerson: Unable to load"+e+".")})},error:function(){l=e(l.element),ui.modal.showLoading(!1),l.html('<div class="ancGrid ancGridPadded"><div class="ancCol w100"><p class="icon iconWarning">'+PersonCard.text.addPersonErrorText+"</p></div></div>")}})}};c.open=!0,o.showAddNewOnly&&(c.trigger=document.getElementById("editToolsButton")),ui.modal('<div id="AddPersonModal"></div>',c)},Add:function(e,a,d,s){new AddPerson.Modal(e,a,d,s,"add")},Edit:function(e,a,d,s,o){"string"==typeof d?d=JSON.parse(d):void 0===d&&(d={}),"object"==typeof d&&(d.otid||(d.otid=e),d.opid||(d.opid=a)),new AddPerson.Modal(e,a,d,s,"edit",o)}}}(jQuery);
//# sourceMappingURL=AddPerson-582aa316.min.js.map