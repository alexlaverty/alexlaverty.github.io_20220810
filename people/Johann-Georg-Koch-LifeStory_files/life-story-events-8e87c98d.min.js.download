"use strict";function savePersonNarrativeAndEventData(e,t){var n=e.storyItem.find(".eventType").val(),i=e.storyItem.find("#"+e.assertId+"LocationField").data("extra"),a="",r=!0;void 0!==window.placeFieldDataExtra&&$.each($.parseJSON(i),function(e,t){"GPID"===e&&(a=t)});var o="";if(e.eventChanged&&e.narrChanged?o="0":e.eventChanged?o="1":e.narrChanged&&(o="2"),""!==o||!0===e.hiddenMedia){!0===e.hiddenMedia&&e.storyItem.find(".mediaItemHidden").each(function(){var e=$(this),t=e.data("event-id"),n=e.data("media-id");window.detachMediaFromEvent(t,n,null)});var d=window.getPersonAjaxUrlPrefix()+"/tree/"+window.PersonCard.treeId+"/person/"+window.PersonCard.personId+"/assertionid/"+e.assertId+"/savepersonnarrativeandeventdata";$.ajax({type:"POST",url:d,cache:!1,timeout:2e4,data:{saveContentValue:o,title:e.narrTitleVal,narrative:e.storyNarrVal,isHidden:e.sItemHidn,isMapOn:e.sItemMapVis,isImageOn:e.sItemShowMediaOn,preferredImageId:e.storyItem.find(".storyPreferredImageId").val(),eventId:e.storyItem.find(".eventId").val(),eventType:n,date:e.dateVal,place:e.placeVal,placeGpid:a,description:e.descrVal,relationshipId:e.relId},success:function(){r=!0,"undefined"!==t&&t(r,e.reqRefresh,o)},error:function(){null!==window.acom&&null!==window.acom.bus&&"undefined"!==window.PersonStory&&(window.acom.bus.emit("LifeStory::Notify::Failure",window.PersonStory.narrative.updateError,"",!0),r=!1),"undefined"!==t&&t(r,!1,o)}})}else"undefined"!==t&&t(!0,e.reqRefresh,o);return r}function ignoreHistoricalInsight(e){$("."+e).remove();var t=getPersonAjaxUrlPrefix()+"/tree/"+PersonCard.treeId+"/person/"+PersonCard.personId+"/historicalinsightid/"+e+"/ignoreHistoricalInsight";$.ajax({url:t,method:"GET"})}$(function(){loadScripts(PersonStory.jsAssets,function(){$(".HistoricalInsight .mediaList").removeClass("loading"),$(".timelineItem:not(.HistoricalInsight) .mediaList").each(function(){function e(){switch(t.find("img").length){case 1:t.closest(".timelineItem").addClass("timelineItemMediaIs1Col");break;case 2:t.closest(".timelineItem").addClass("timelineItemMediaIs2Col")}t.addClass("viewAsMasonry").removeClass("loading")}var t=$(this);$.fn.imagesLoaded?t.imagesLoaded().done(function(){e()}):e()})}),$html.off("click.timelineListEditButton").on("click.timelineListEditButton","ul.timelineList .editButton",function(){var e=$(this),t=e.closest(".timelineItem"),n=t.find(".eventId");"True"===window.PersonCard.showNodeFEM?(window.PersonStory.personData.factEditContentUrl=window.PersonStory.factEditContentUrl,window.PersonResearch||(window.PersonResearch={openOnLoadTab:0}),window.nodeFactEditModal(window.PersonStory.personData,n.attr("value"))):alert("This will not work because window.PersonCard.showNodeFEM is set to False.")})});
//# sourceMappingURL=life-story-events-8e87c98d.min.js.map