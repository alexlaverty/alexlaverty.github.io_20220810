"use strict";function ownKeys(t,e){var i,n=Object.keys(t);return Object.getOwnPropertySymbols&&(i=Object.getOwnPropertySymbols(t),e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)),n}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(i),!0).forEach(function(e){_defineProperty(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):ownKeys(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}function _defineProperty(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function t(e,i,n){function r(o,l){if(!i[o]){if(!e[o]){var s="function"==typeof require&&require;if(!l&&s)return s(o,!0);if(a)return a(o,!0);throw(s=new Error("Cannot find module '"+o+"'")).code="MODULE_NOT_FOUND",s}s=i[o]={exports:{}},e[o][0].call(s.exports,function(t){return r(e[o][1][t]||t)},s,s.exports,t,e,i,n)}return i[o].exports}for(var a="function"==typeof require&&require,o=0;o<n.length;o++)r(n[o]);return r}({1:[function(t,e,i){var n=t("hogan.js"),t=function(t){for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(this[e]=t[e]);for(var i in this.$el=this.$el||$("<div/>"),this.template=this.template||n.compile(""),this.events=this.events||{},this.model=this.model||{data:{urlParams:{}}},this.events){var r,a;"string"==typeof i&&Object.prototype.hasOwnProperty.call(this.events,i)&&(r=(a=i.split(":"))[0],a=a[1],i=this[this.events[i]].bind(this),r?this.$el.on(a,r,i):this.$el.on(a,i))}};t.prototype.render=function(){return this},t.prototype.init=function(){return this},e.exports=t},{"hogan.js":15}],2:[function(t,e,i){var n=t("hogan.js"),r=t("./basecontroller"),a=t("../models/gallerymodel"),o=t("./subcontrollers/gallerylistcontroller"),l=t("./subcontrollers/filtercontroller"),s=t("./subcontrollers/sortcontroller"),c=t("./subcontrollers/addmediacontroller"),d=n.compile('<section class="mediaGallery" id="AcomMediaGallery">\n\t{{> galleryHeader }}\n\t<div class="galleryContent">\x3c!-- Gallery List goes here. --\x3e</div>\n</section>\n<script type="text/template" id="mediaGalleryFilterList">\n\t<h5 class="calloutMenuTitle" data-i18n="mediaType">Media Type</h5>\n\t<ul class="calloutMenu" id="mediaFilterType">\n\t\t<li data-value="all">\n\t\t\t<button class="link iconAfter iconAfterCheck icon iconGallery calloutMenuChecked"\n\t\t\t\t\taria-pressed="true" data-type="all" data-i18n="all" type="button">All</button>\n\t\t</li>\n\t\t<li data-value="portrait">\n\t\t\t<button class="link iconAfter iconAfterCheck icon iconImage calloutMenuUnchecked"\n\t\t\t\t\taria-pressed="false" data-type="p" data-i18n="photos" type="button">Photos</button>\n\t\t</li>\n\t\t<li data-value="record media">\n\t\t\t<button class="link iconAfter iconAfterCheck icon iconNote calloutMenuUnchecked"\n\t\t\t\t\taria-pressed="false" data-type="rm" data-i18n="records" type="button">Records</button>\n\t\t</li>\n\t\t<li data-value="story">\n\t\t\t<button class="link iconAfter iconAfterCheck icon iconStory calloutMenuUnchecked"\n\t\t\t\t\taria-pressed="false" data-type="s" data-i18n="stories" type="button">Stories</button>\n\t\t</li>\n\t\t<li data-value="audio">\n\t\t\t<button class="link iconAfter iconAfterCheck icon iconAudio calloutMenuUnchecked"\n\t\t\t\t\taria-pressed="false" data-type="a" data-i18n="audio" type="button">Audio</button>\n\t\t</li>\n\t\t<li data-value="video">\n\t\t\t<button class="link iconAfter iconAfterCheck icon iconVideo calloutMenuUnchecked"\n\t\t\t\t\taria-pressed="false" data-type="v" data-i18n="video" type="button">Video</button>\n\t\t</li>\n\t</ul>\n<\/script>\n\n<script type="text/template" id="mediaGallerySortList">\n\t<h5 class="calloutMenuTitle" data-i18n="sortBy">Sort By</h5>\n\t<ul class="calloutMenu" id="mediaSortby">\n\t\t<li>\n\t\t\t<button class="sortBtn link iconAfter iconAfterCheck icon calloutMenuUnchecked" data-i18n="mediaType" aria-pressed="false" data-sort="sortbymediatype" type="button">Media Type</button>\n\t\t</li>\n\t\t<li data-value="dateAddedAsc">\n\t\t\t<button class="sortBtn link iconAfter iconAfterCheck icon calloutMenuUnchecked" data-i18n="dateAddedNewest" aria-pressed="false" data-sort="sortbydatenewest" type="button">Date Added (Newest)</button>\n\t\t</li>\n\t\t<li data-value="dateAddedDesc">\n\t\t\t<button class="sortBtn link iconAfter iconAfterCheck icon calloutMenuUnchecked" data-i18n="dateAddedOldest" aria-pressed="false" data-sort="sortbydateoldest" type="button">Date Added (Oldest)</button>\n\t\t</li>\n\t\t<li data-value="titleAsc">\n\t\t\t<button class="sortBtn link iconAfter iconAfterCheck icon calloutMenuUnchecked" data-i18n="titleAZ" aria-pressed="false" data-sort="sortbytitleaz" type="button">Title A-Z</button>\n\t\t</li>\n\t\t<li data-value="titleDesc">\n\t\t\t<button class="sortBtn link iconAfter iconAfterCheck icon calloutMenuUnchecked" data-i18n="titleZA" aria-pressed="false" data-sort="sortbytitleza" type="button">Title Z-A</button>\n\t\t</li>\n\t</ul>\n<\/script>\n\n<script type="text/template" id="deleteCalloutContent">\n\t<ul class="calloutMenu">\n\t\t<li>\n\t\t\t<button class="icon iconUnlink removeCard unlinkCard link" data-i18n="remove from gallery">Remove from Gallery</button>\n\t\t</li>\n\t\t<li>\n\t\t\t<button class="icon iconTrash removeCard deleteCard link" data-i18n="delete from tree">Delete from Tree</button>\n\t\t</li>\n\t</ul>\n<\/script>\n\n<script type="text/template" id="mediaUploadOptions">\n\t<ul id="addMediaMenu" class="calloutMenu">\n\t\t<li>\n\t\t\t<a href="{{photoUploadLink}}" class="link icon iconUpload" data-i18n="uploadPhotos" data-mediatype="photo"\n\t\t\t\tdata-uploadtype="photo" type="button">\n\t\t\t\tUpload Photos\n\t\t\t</a>\n\t\t</li>\n\t\t<li>\n\t\t\t<a href="{{storyUploadLink}}" class="link icon iconUpload" data-i18n="uploadStory" data-mediatype="story"\n\t\t\t\tdata-uploadtype="upload-story" type="button">\n\t\t\t\tUpload Story\n\t\t\t</a>\n\t\t</li>\n\t\t<li>\n\t\t\t<a href="{{storyCreationLink}}" class="link icon iconAdd" data-i18n="createStory" data-mediatype="story"\n\t\t\t\tdata-uploadtype="create-story" type="button">\n\t\t\t\tCreate Story\n\t\t\t</a>\n\t\t</li>\n\t</ul>\n<\/script>\n'),u=n.compile('\t<form class="form">\n\t\t<div class="ancGrid ancGridRow">\n\t\t\t<div class="ancCol w60 filters">\n\t\t\t\t{{^isEmptyGallery}}\n\t\t\t\t<div class="galleryCallouts">\n\t\t\t\t\t<button class="mediaFilter ancBtn silver calloutTrigger iconAfter iconArrowSmallDownAfter" data-i18n="show" type="button">Show</button>\n\t\t\t\t\t<button class="mediaSort ancBtn silver calloutTrigger iconAfter iconArrowSmallDownAfter" data-i18n="sort" type="button">Sort</button>\n\t\t\t\t</div>\n\t\t\t\t{{/isEmptyGallery}}\n\t\t\t</div>\n\t\t\t<div class="ancCol w40 addEdit textRight">\n\t\t\t\t{{#canEdit}}\n\t\t\t\t<div class="galleryCallouts">\n\t\t\t\t\t<button class="icon ancBtn silver calloutTrigger iconAfter iconArrowSmallDownAfter mediaAddItem" data-i18n="add" type="button">Add</button>\n\t\t\t\t\t<button class="icon iconEdit ancBtn silver mediaEditItem" data-i18n="edit" type="button">Edit</button>\n\t\t\t\t</div>\n\t\t\t\t{{/canEdit}}\n\t\t\t</div>\n\t\t</div>\n\t</form>\n'),p=t("../lib/translations"),h=t("../lib/utility")(),f=new r({model:new a,init:function(){var t=h.getEnv(),e=h.getLcid();$("#selector-config").remove(),$("#selector-resourceStrings").remove(),$("#selector-container").remove();var i=h.getGalleryType();return"selector"===i&&(i="person"),"dev"!==t&&window.mediaOmniture&&window.mediaOmniture.runOmniture(t,e,i),this.model.galleryType=i,this.$el=$("#"+this.model.galleryType+"-container"),$(this.model).on("sync",this.render.bind(this)),$(this.model).on("sync",function(){var t=h.getParameterByName("filter").toLowerCase();this.model.setFilters(t.split(","))}.bind(this)),$(this.model).on("sync",function(){var t=h.getParameterByName("sort").toLowerCase();t in mediaApp.sorters&&this.model.applySort(t)}.bind(this)),this.model.fetch(),$.fn.toggleCheckmark=function(t){var e="calloutMenuUnchecked",i="calloutMenuChecked";$(this).each(function(){var n=$(this);"show"===t?(n.removeClass(e).addClass(i),n.attr("aria-pressed",!0)):"hide"===t&&(n.removeClass(i).addClass(e),n.attr("aria-pressed",!1))})},this},render:function(){var t=this,e=[o,l,s,c],i=d.render(this.model.data,{galleryHeader:u});return this.$el.html(p($(i)).translation).removeClass("loading loadingLarge"),$.each(e,function(e,i){i.model=t.model,i.$parentEl=t.$el,i.init().render()}),this}});$(document).ready(function(){f.init()})},{"../lib/translations":9,"../lib/utility":11,"../models/gallerymodel":13,"./basecontroller":1,"./subcontrollers/addmediacontroller":3,"./subcontrollers/filtercontroller":5,"./subcontrollers/gallerylistcontroller":6,"./subcontrollers/sortcontroller":7,"hogan.js":15}],3:[function(t,e,i){var n=t("../basecontroller"),r=t("../../lib/translations");e.exports=new n({render:function(){var t=$("#mediaUploadOptions").html(),e=r($(t)).translation,t=$(".mediaAddItem");return t&&window.ui.callout(t[0],{content:e[0],keepContentInPlace:!0,onOpen:this.bindCalloutEvents.bind(this),calloutStyle:"dark"}),this},bindCalloutEvents:function(){return this}})},{"../../lib/translations":9,"../basecontroller":1}],4:[function(t,e,i){var n=t("../basecontroller"),r=t("../../lib/translations");e.exports=new n({render:function(){var t=this;return $(".deleteImageBtn").addClass("calloutTriggerNoArrow").on("click",function(e){var i,n,a=$(this);e.preventDefault(),a&&!a.hasClass("calloutTrigger")&&(i=a.attr("data-objectid"),n=window.ui.callout(a[0],{calloutClasses:i,content:r($("#deleteCalloutContent").html()).translation[0],onAfterOpen:function(){function e(){a.closest("div").children(".mediaObject").addClass("fadeOut").one("webkitTransitionEnd transitionend",function(){$(this).parent().remove()}),n.destroy()}$("."+i).on("click",".unlinkCard",function(){t.model.unlinkMedia(i),e()}).on("click",".deleteCard",function(){t.model.deleteMedia(i),e()})},calloutStyle:"dark"}),setTimeout(function(){n.open()},1))}),t}})},{"../../lib/translations":9,"../basecontroller":1}],5:[function(t,e,i){var n=t("../basecontroller"),r=t("../../lib/translations");e.exports=new n({render:function(){var t=$("#mediaGalleryFilterList").html(),e=$(".mediaFilter");return e&&window.ui.callout(e[0],{content:r($(t)).translation[0],calloutStyle:"dark",keepContentInPlace:!0,onOpen:this.initMenu.bind(this)}),this},initMenu:function(){var t,e,i;return 0!==this.model.typeFilters.length&&(t=this,e=(i=$("#mediaFilterType").find("li .link")).filter('[data-type="all"]'),i=i.not('[data-type="all"]'),e.toggleCheckmark("hide"),i.each(function(){-1!==t.model.typeFilters.indexOf($(this).attr("data-type"))&&$(this).toggleCheckmark("show")})),this.bindCalloutEvents.call(this),this},bindCalloutEvents:function(){return $("#mediaFilterType").off().on("click",".link",this.toggleFilter.bind(this)),this},toggleFilter:function(t){var e=$(t.currentTarget),i=e.data().type,n="all"===i,r=e.parents("ul").find("li .link"),t=r.filter('[data-type="all"]'),r=r.not('[data-type="all"]');return e.hasClass("calloutMenuUnchecked")?(this.model.addFilter(i),n?(t.toggleCheckmark("show"),r.toggleCheckmark("hide")):(e.toggleCheckmark("show"),t.toggleCheckmark("hide"))):n||(this.model.removeFilter(i),e.toggleCheckmark("hide"),r.hasClass("calloutMenuChecked")||t.toggleCheckmark("show")),this}})},{"../../lib/translations":9,"../basecontroller":1}],6:[function(t,e,i){function n(t,e){r("link","media_upload_intent_click",t,{click_location:e})}function r(t,e,i,n){if(n&&"object"===_typeof(n)&&"object"===_typeof(window.utag)&&e&&"string"==typeof e&&i&&"string"==typeof i&&("view"===t||"link"===t)&&"function"==typeof window.utag[t])try{var r="family history";window.utag[t](_objectSpread(_objectSpread({},n),{},{stack:"trees",page_name_var:i,feature:"trees",feature_category:r,page_name_fullpath:"".concat(r," : ").concat("trees"," : ").concat(i),mix_event_name:e}))}catch(t){}}var a=t("hogan.js"),o=(t("../../lib/utility")(),t("../basecontroller")),l=t("./deleteimagecontroller"),s=a.compile('<div class="gallery{{#isSelector}} selector{{/isSelector}}">\n\t{{^serviceError}}\n\t\t{{#objects}}\n\t\t\t{{#active}}\n\t\t\t\t{{#isStory}}\n\t\t\t\t\t{{> storyCard}}\n\t\t\t\t{{/isStory}}\n\t\t\t\t{{#isRecord}}\n\t\t\t\t\t{{> recordCard}}\n\t\t\t\t{{/isRecord}}\n\t\t\t\t{{#isPhoto}}\n\t\t\t\t\t{{> photoCard}}\n\t\t\t\t{{/isPhoto}}\n\t\t\t\t{{#isAudio}}\n\t\t\t\t\t{{> audioCard}}\n\t\t\t\t{{/isAudio}}\n\t\t\t\t{{#isVideo}}\n\t\t\t\t\t{{> videoCard}}\n\t\t\t\t{{/isVideo}}\n\t\t\t{{/active}}\n\t\t{{/objects}}\n\n\t\t\x3c!--Empty selector message--\x3e\n\t\t{{#isSelector}}\n\t\t\t{{^showUploadLink}}\n\t\t\t\t{{#isEmptyGallery}}\n\t\t\t\t<div class="emptyGallery">\n\t\t\t\t\t<div class="cardEmptyAction icon iconGallery" data-i18n="emptySelectorGallery"></div>\n\t\t\t\t</div>\n\t\t\t\t{{/isEmptyGallery}}\n\t\t\t\t{{^isEmptyGallery}}\n\t\t\t\t\t{{#isEmptyWithFilters}}\n\t\t\t\t\t\t<div class="emptyGallery">\n\t\t\t\t\t\t\t<div class="cardEmptyAction icon iconGallery" data-i18n="emptySelectorGallery"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{{/isEmptyWithFilters}}\n\t\t\t\t{{/isEmptyGallery}}\n\t\t\t{{/showUploadLink}}\n\t\t{{/isSelector}}\n\n\t\t\x3c!--Gallery--\x3e\n\t\t{{^isSelector}}\n\t\t\t{{#isEmptyWithFilters}}\n\t\t\t\t{{^isEmptyGallery}}\n\t\t\t\t\t<div class="emptyFilter">\n\t\t\t\t\t\t<div class="cardEmptyAction icon iconGallery" data-i18n="emptyFilter"\n\t\t\t\t\t\t\t\tdata-i18n-options=\'{ "count": {{filterCount}} }\'>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t{{/isEmptyGallery}}\n\t\t\t{{/isEmptyWithFilters}}\n\n\t\t\t<div class="hasEditingRights">\n\t\t\t\t{{#canEdit}}\n\t\t\t\t\t{{#isEmptyGallery}}\n\t\t\t\t\t\t<a href="{{mediaUploadLink}}" aria-pressed="false" class="emptyGallery card cardEmpty textCenter"\n\t\t\t\t\t\t\trole="button" tabindex="0" data-toggle-classes="cardSelected cardOutline2">\n\t\t\t\t\t\t\t<div class="cardEmptyAction textCenter icon iconGallery" data-i18n="emptyGallery"></div>\n\t\t\t\t\t\t</a>\n\t\t\t\t\t{{/isEmptyGallery}}\n\n\t\t\t\t\t{{^isEmptyWithFilters}}\n\t\t\t\t\t\t{{^isEmptyGallery}}\n\t\t\t\t\t\t\t<a href="{{mediaUploadLink}}" aria-pressed="false" class="card cardEmpty textCenter cardSize1" role="button">\n\t\t\t\t\t\t\t\t<div class="cardEmptyAction textCenter icon iconGallery textxlrg" data-i18n="emptyGallery"></div>\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t{{/isEmptyGallery}}\n\t\t\t\t\t{{/isEmptyWithFilters}}\n\t\t\t\t\t\n\t\t\t\t{{/canEdit}}\n\n\t\t\t\t{{^canEdit}}\n\t\t\t\t\t{{#isEmptyGallery}}\n\t\t\t\t\t\t<div class="emptyGallery">\n\t\t\t\t\t\t\t<div class="cardEmptyAction icon iconGallery" data-i18n="noMedia"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{{/isEmptyGallery}}\n\t\t\t\t{{/canEdit}}\n\t\t\t</div>\n\t\t{{/isSelector}}\n\t{{/serviceError}}\n\n\t{{#serviceError}}\n\t\t<div class="emptyGallery">\n\t\t\t<div class="cardEmptyAction" data-i18n="serviceError"></div>\n\t\t</div>\n\t{{/serviceError}}\n\n\t{{#showUploadLink}}\n\t\t<a href="{{mediaUploadLink}}" aria-pressed="false" class="card cardEmpty textCenter cardSize1" role="button">\n\t\t\t<div class="cardEmptyAction textCenter icon iconGallery textxlrg" data-i18n="emptyGallery"></div>\n\t\t</a>\n\t{{/showUploadLink}}\n</div>'),c=a.compile('<div>\n\t<a href="{{viewerUrl}}"\n\t\taria-label="{{title}}"\t\n\t\tclass="mediaObject card cardMedia cardMediaFull cardSize1 bgDark bgColor7 bgTexture3 fade{{#isSelected}} selectedCard selector{{/isSelected}}"\n\t\t{{#previewBackgroundUrl}}style="background-image:url({{previewBackgroundUrl}});"{{/previewBackgroundUrl}}\n\t\ttabindex="0">\n\t{{> figureCaption}}\n\t</a>\n\t{{> figureIcons}}\n\t{{#isEnhanced}}\n\t<img class="icon iconEnhanced" title="{{enhancedTooltip}}" alt="{{enhancedTooltip}}" src="https://www.ancestrycdn.com/mediaui-viewer/images/enhance-0b071769.svg">\n\t{{/isEnhanced}}\n</div>'),d=a.compile('<div>\n\t<a href="{{viewerUrl}}"\n\t\taria-label="{{title}}"\n\t\tclass="mediaObject card cardMedia cardMediaFull cardSize1 bgDark bgColor7 bgTexture3 fade icon iconStory\n\t\t\t{{#fileFormat}} iconDocument{{fileFormat}} {{/fileFormat}}\n\t\t\t{{#isSelected}} selectedCard selector {{/isSelected}}"\n\t\t{{#previewBackgroundUrl}} style="background-image:url({{previewBackgroundUrl}});" {{/previewBackgroundUrl}}>\n\t\t{{> figureCaption}}\n\t</a>\n\t{{> figureIcons}}\n</div>'),u=a.compile('<div>\n<a href="{{viewerUrl}}" class="mediaObject icon iconAudio card cardMedia cardMediaFull cardSize1 bgDark bgColor7 bgTexture3 fade{{#isSelected}} selectedCard selector{{/isSelected}}"\n\taria-label="{{title}}"\n\t{{#previewBackgroundUrl}}\n\tstyle="background-image:url({{previewBackgroundUrl}});"\n\t{{/previewBackgroundUrl}}>\n{{> figureCaption}}\n</a>\n{{> figureIcons}}\n</div>'),p=a.compile('<div>\n\t<a href="{{viewerUrl}}" class="mediaObject icon iconVideo card cardMedia cardMediaFull cardSize1 bgDark bgColor7 bgTexture3 fade{{#isSelected}} selectedCard selector{{/isSelected}}"\n\t\taria-label="{{title}}"\n\t\t{{#previewBackgroundUrl}}\n\t\tstyle="background-image:url({{previewBackgroundUrl}});"\n\t\t{{/previewBackgroundUrl}}>\n\n\t\t{{> figureCaption}}\n\t</a>\n\t{{> figureIcons}}\n</div>'),h=a.compile('<div>\n\t<a href="{{viewerUrl}}" class="mediaObject card cardMedia cardMediaFull cardSize1 bgDark bgColor7 bgTexture3 fade"\n\t aria-label="{{title}}"\n\t {{#previewBackgroundUrl}}\n\t style="background-image:url({{previewBackgroundUrl}});"\n\t {{/previewBackgroundUrl}}>\n\t\t<figure class="cardFigure">\n\t\t\t<img class="mediaInfo screenReaderText" data-mediaid="{{id}}" data-mediatype="rm" alt="{{title}}" src="{{previewSourceUrl}}" />\n\t\t\t{{> figureCaption}}\n\t\t</figure>\n\t</a>\n\t{{> figureIcons}}\n</div>'),f=a.compile('<div class="mediaInfo" data-media-id="{{id}}" data-media-type="{{type}}" data-crop-coords="{{cropCoords}}"></div>\n<div class="cardContentWrapper">\n\t<span class="icon iconCheck"></span>\n\t<figure class="cardFigure">\n\t\t<div class="cardCaption cardContent">\n\t\t\t<h3 class="cardTitle" title="{{title}}">{{title}}</h3>\n\t\t</div>\n\t</figure>\n</div>'),m=a.compile('<p class="cardFigure cardInfo">\n\t{{#hasLikes}}\n\t<small class="icon iconHeart noDisplay">{{meta.likes}}</small>\n\t{{/hasLikes}}\n\t{{#hasComments}}\n\t<small class="icon iconChat noDisplay">{{meta.comments}}</small>\n\t{{/hasComments}}\n\t{{#canEdit}}\n\t<button class="icon iconTrash link deleteImageBtn" data-objectId="{{id}}" data-position="top" type="button"><span class="hideVisually" data-i18n="delete">Delete</span></button>\n\t{{/canEdit}}\n</p>'),y=a.compile('<div class="alert">\n\t<strong data-i18n="enhanceCalloutTitle"></strong>\n\t<p data-i18n="enhanceCalloutContent"></p>\n</div>'),g=t("../../lib/translations");e.exports=new o({$el:null,template:s,filters:-1,pageName:null,init:function(){var t=this;return this.$el=this.$parentEl.find(".galleryContent"),$(this.model).on("change",this.render.bind(this)),this.bindGalleryListEvents(),this.pageName="".concat(this.model.galleryType," media gallery"),document.addEventListener("click",function(e){var i=e.target;if(i.classList)if(i.classList.contains("mediaObject")){var e=i.querySelector(".mediaInfo"),a="";switch(e?e.getAttribute("data-media-type")||e.getAttribute("data-mediatype"):""){case"a":a="audio";break;case"p":a="photo";break;case"s":a="story";break;case"v":a="video";break;case"rm":a="record"}e=t.pageName,t.model.typeFilters,r("link","media_gallery_content_click",e,{media_type:a})}else i.classList.contains("cardEmpty")||i.classList.contains("cardEmptyAction")?n(t.pageName,"icon"):i.classList.contains("mediaAddItem")&&n(t.pageName,"button")}),this},render:function(){var t=Array.isArray(this.model.typeFilters)?this.model.typeFilters.length:-1;t!==this.filters&&(this.filters=t,e=this.pageName,this.model.typeFilters,r("view","media_gallery_view",e,{}));var e=this.template.render(this.model.data,{photoCard:c,recordCard:h,storyCard:d,audioCard:u,videoCard:p,figureCaption:f,figureIcons:m});return this.$el.html(g($(e)).translation),l.model=this.model,l.init().render(),this.renderPhotoEditGrowl(),this},renderPhotoEditGrowl:function(){var t=this,e=this.model.data;if(!this.photoEditGrowl&&e.canEdit&&!this.showPersonGalleryCalloutPromise&&!window.peGrowl&&(e=e.objects,Array.isArray(e)&&e.find(function(t){return"photo"===t.category})))return this.showPersonGalleryCalloutPromise=fetch("/mediaui-viewer/api/callout?type=pg").then(function(t){return t.json()}).then(function(e){!e||t.photoEditGrowl||window.peGrowl||(e=g(y.render()).translation,document.querySelector(".mediaGallery .galleryContent").prepend(e[0]),window.peGrowl=t.photoEditGrowl=window.ui.alert(document.querySelector(".galleryContent .alert"),{closable:!0,open:!0,type:"info",destroyOnClose:!0,onClose:function(){fetch("/mediaui-viewer/api/callout?type=pg",{method:"POST"}).catch(function(t){})}}))}).catch(function(){return!1}),this.showPersonGalleryCalloutPromise},bindGalleryListEvents:function(){this.$el.off().on("click","a.mediaObject",this.handleCardClick.bind(this))},handleCardClick:function(t){var e=this;$(t.originalEvent.target).attr("href",function(){var t=$(this).attr("href");return t+e.model.getFilterSortQueryString(t)})}})},{"../../lib/translations":9,"../../lib/utility":11,"../basecontroller":1,"./deleteimagecontroller":4,"hogan.js":15}],7:[function(t,e,i){var n=t("../basecontroller"),r=t("../../lib/translations");e.exports=new n({render:function(){var t=$("#mediaGallerySortList").html(),e=r($(t)).translation,t=$(".mediaSort");return t&&window.ui.callout(t[0],{calloutClasses:"mediaSortCallout",content:e[0],calloutStyle:"dark",onAfterOpen:this.initMenu.bind(this)}),this},initMenu:function(){return $("#mediaSortby").find('[data-sort="'+this.model.sortType.current+'"]').toggleCheckmark("show"),this.bindCalloutEvents.call(this),this},bindCalloutEvents:function(){return $(".mediaSortCallout").off().on("click",".sortBtn",this.applySort.bind(this)),this},applySort:function(t){var e=$(t.currentTarget),t=e.parents("ul");e.hasClass("calloutMenuChecked")?e.data().sort!==this.model.sortType.default&&(e.toggleCheckmark("hide"),this.model.applySort(this.model.sortType.default),t.find('li .sortBtn[data-sort="'+this.model.sortType.default+'"]').toggleCheckmark("show")):(t.find("li .sortBtn").toggleCheckmark("hide"),this.model.applySort(e.data().sort),e.toggleCheckmark("show"))}})},{"../../lib/translations":9,"../basecontroller":1}],8:[function(t,e,i){$.ajaxPrefilter("json",function(t,e,i){return t.crossDomain&&!$.support.cors?"jsonp":"json"});var n=t("./urlmaker")(),r=t("./utility")();e.exports=function(){function t(t,e,i,n){return t=t||$.noop,n={url:e,cache:!1,data:i=i||{},dataType:"json",crossDomain:!0,type:n=n||"GET",xhrFields:{withCredentials:!0},timeout:r.getAjaxTimeout()||5e3,success:function(e,i,n){"string"==typeof e&&(e=JSON.parse(e)),t(e)},error:function(e,i,n){if(200===e.status){if("string"==typeof e.responseText){var r={};try{r=JSON.parse(e.responseText)}catch(n){}t(r)}}else t(!1)},fail:function(){t(!1)}},$.ajax(n)}return{getMediaList:function(e,i){t(i,n.getMediaListUrl(e),null,"GET")},deleteMedia:function(e,i,r){t(r,n.getMediaDeleteUrl(e,i),{},"DELETE")},unlinkMedia:function(e,i,a){i=n.getMediaUnlinkUrl(e,i),r.useMediaUIGallery()?t(a,i,{},"DELETE"):t(a,i,{treeId:e.treeId},"DELETE")}}}},{"./urlmaker":10,"./utility":11}],9:[function(t,e,i){var n=JSON.parse($("#selector-resourceStrings").html()||$("#apv-resourceStrings").html()||$("#person-resourceStrings").html()||$("#tree-resourceStrings").html());e.exports=function(t){function e(t){return n[t]}return t=$("<div/>").html(t||$("body")),t.find("[data-i18n],[data-i18n-placeholder]").each(function(){var t=$(this),i=t.data("i18n"),n=t.data("i18nOptions"),r=t.data("i18nPlaceholder");n&&n.count&&1!==n.count&&(i+="_plural"),r&&t.attr("placeholder",e(r)),i&&t.text(e(i))}),{translatePhrase:e,translation:t}}},{}],10:[function(t,e,i){var n=t("./utility")();e.exports=function(){function t(t,e){return t?n.getIIVUrlPrefix()+"/"+t.collectionId+"/"+t.id+"/"+t.recordId+"?backurl="+encodeURIComponent(e):null}function e(t){return t?n.getTreesUrlPrefix()+"/pt/EditStory.aspx?tid="+t.treeId+"&pid="+t.personId:null}function i(t,e){return t?n.getMediaUploadUrlPrefix()+"/tree/"+t.treeId+"/person/"+t.personId+"/"+e+"/upload":null}function r(t,e){var i;return i=t?n.useMediaUIViewer()?n.getMediaUiViewerUrlPrefix()+"/collection/"+t.collectionId+"/tree/"+t.treeId+"/person/"+t.personId+"/media/"+e:a(i=n.getMediaViewerUrlPrefix()+"/viewer/"+e+"/"+t.treeId+"/"+t.personId,t):i}function a(t,e){return e&&e.collectionId&&(t+=(/\?/.test(t)?"&":"?")+"collectionId="+e.collectionId),t}return{getIIVUrl:function(e,i,n){var r;e&&(r={destInputs:{CollectionId:e.collectionId,ImageId:e.id,RecordId:e.recordId,BackUrl:i},useCurrentPageInfo:!0},window.ancestry&&window.ancestry.pub?ancestry.pub.getUrl("InteractiveImageViewer",r,function(r,a){r?(r=t(e,i),n(r)):n(a)}):(r=t(e,i),n(r)))},getMediaDeleteUrl:function(t,e){return e=n.useMediaUIGallery()?n.getMediaUiGalleryUrlPrefix()+"/api/tree/"+t.treeId+"/media/"+e:n.getMediaServiceUrlPrefix()+"/api/trees/"+t.treeId+"/media/"+e},getMediaListUrl:function(t){var e;return t&&(e=n.useMediaUIService()?n.mediaUiServiceUrlPrefix()+"/api/collection/"+t.collectionId+"/tree/"+t.treeId+"/person/"+t.personId+"/media":a(e=n.getMediaServiceUrlPrefix()+"/v1/trees/"+t.treeId+"/people/"+t.personId+"?excludeInlineStories=1",t),t.excludeTypes&&(e+=(/\?/.test(e)?"&":"?")+"exclude="+t.excludeTypes),n.getLcid()&&(e+=(/\?/.test(e)?"&":"?")+"lcid="+n.getLcid())),e},getMediaUnlinkUrl:function(t,e){var i;return i=t?n.useMediaUIGallery()?n.getMediaUiGalleryUrlPrefix()+"/api/tree/"+t.treeId+"/person/"+t.personId+"/media/"+e:n.getMediaServiceUrlPrefix()+"/v1/person/"+t.personId+"/"+e:i},getStoryCreateUrl:function(t,i){var n;t&&(n={destInputs:{TreeId:t.treeId,PersonId:t.personId},useCurrentPageInfo:!0,currentPageIsStart:!0},window.ancestry&&window.ancestry.pub?ancestry.pub.getUrl("PersonStoryEdit",n,function(n,r){n?(n=e(t),i(n)):i(r)}):(n=e(t),i(n)))},getUploadMediaUrl:function(t,e,n){var r;t&&(r={destInputs:{MediaType:e,TreeId:t.treeId,PersonId:t.personId},useCurrentPageInfo:!0,currentPageIsStart:!0},window.ancestry&&window.ancestry.pub?ancestry.pub.getUrl("PersonMediaObjectUpload",r,function(r,a){r?(r=i(t,e),n(r)):n(a)}):(r=i(t,e),n(r)))},getViewerUrl:function(t,e,i){var n;t&&(n={destInputs:{MediaId:e,CollectionId:t.collectionId,TreeId:t.treeId,PersonId:t.personId},useCurrentPageInfo:!0},window.ancestry&&window.ancestry.pub?ancestry.pub.getUrl("PersonMediaViewer",n,function(n,a){n?(n=r(t,e),i(n)):i(a)}):(n=r(t,e),i(n)))}}}},{"./utility":11}],11:[function(t,e,i){var n=JSON.parse($("#selector-config").html()||$("#apv-config").html()||$("#person-config").html()||$("#tree-config").html());e.exports=function(){return{getAjaxTimeout:function(){return n.ajaxTimeout||5e3},getEnv:function(){return n.env||""},getIIVUrlPrefix:function(){return n.interactiveUrlPrefix||""},getGalleryType:function(){return n.galleryType||""},getLcid:function(){return n.lcid||1033},getMediaServiceUrlPrefix:function(){return n.mediaServiceUrlPrefix||""},getMediaUploadUrlPrefix:function(){return n.mediaUploadUrlPrefix||""},getMediaViewerUrlPrefix:function(){return n.mediaViewerUrlPrefix||""},getMediaUiGalleryUrlPrefix:function(){return n.mediaUiGalleryUrlPrefix||""},getMediaUiServiceUrlPrefix:function(){return n.mediaUiServiceUrlPrefix||""},getMediaUiViewerUrlPrefix:function(){return n.mediaUiViewerUrlPrefix||""},getParameterByName:function(t){return null===(t=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(location.search))?"":decodeURIComponent(t[1])},getParams:function(){return{treeId:n.treeId||"",personId:n.personId||"",collectionId:n.collectionId||"1030"}},getSettings:function(){return n.settings||{}},getTreesUrlPrefix:function(){return n.treesUrlPrefix||""},useMediaUIGallery:function(){return"true"===n.useMediaUIGallery},useMediaUIService:function(){return"true"===n.useMediaUIService},useMediaUIViewer:function(){return"true"===n.useMediaUIViewer}}}},{}],12:[function(t,e,i){function n(t,e){$.extend(this,e),this.data=t,this.parse()}var r=t("../lib/translations")("<div/>");(e.exports=n).prototype.parse=function(){this.setPreviewUrls(),this.setImageAttributes(),this.setMetaAttributes(),this.setCropCoords(),this.setViewerUrl()},n.prototype.setPreviewUrls=function(){var t=this.data;t.previewUrl&&(t.previewBackgroundUrl=t.previewUrl+(/\?/g.test(t.previewUrl)?"&":"?")+"MaxSide=500",t.previewSourceUrl=t.previewUrl)},n.prototype.setImageAttributes=function(){var t,e=this.data;"s"===e.type?(e.isStory=!0,"msword"===e.ext?e.fileFormat="Word":"pdf"===e.ext&&(e.fileFormat="Pdf")):"rm"===e.type?e.isRecord=!0:"p"===e.type?(e.isPhoto=!0,t=(e.origin?e.origin.id:null)||e.id,e.isEnhanced=t!==e.ms_lookup_id,e.enhancedTooltip=r.translatePhrase("edited image")):"a"===e.type?e.isAudio=!0:"v"===e.type&&(e.isVideo=!0),e.isSelected=e.id===this.urlParams.selectedMediaId||this.urlParams.selectedMediaIds&&-1!==this.urlParams.selectedMediaIds.indexOf(e.id),e.canEdit="rm"!==e.type&&e.rights&&e.rights.canEdit,e.active=!0},n.prototype.setMetaAttributes=function(){var t=this.data;t.meta&&(isNaN(t.meta.likes)||(t.hasLikes=!0),isNaN(t.meta.comments)||(t.hasComments=!0))},n.prototype.setCropCoords=function(){var t=this.data,e=t&&t.tags&&t.tags.length?t.tags[0]:null,i=[this.urlParams.personId,this.urlParams.collectionId,this.urlParams.treeId].join(":");e&&"primary"===e.t&&e.tgid.v===i&&e.rect?t.cropCoords=[e.rect.x,e.rect.y,e.rect.w,e.rect.h].join(","):t.cropCoords=""},n.prototype.setViewerUrl=function(){var t=this.data;"rm"===t.type&&"apv"!==this.galleryType?t.viewerUrl=this.iivTemplateUrl.url.replace(this.iivTemplateUrl.collectionId,t.collectionId).replace(this.iivTemplateUrl.id,t.id).replace(this.iivTemplateUrl.recordId,t.recordId):t.viewerUrl=this.viewerTemplateUrl.url.replace(this.viewerTemplateUrl.mediaId,t.id)}},{"../lib/translations":9}],13:[function(t,e,i){var n=t("./galleryitemmodel"),r=t("../lib/mediaservice")(),a=t("../lib/utility")(),o=t("../lib/urlmaker")();e.exports=function(){function t(t,e){for(var i=0;i<t.length;++i)if(t[i].id===e)return t[i];return null}var e=this,i=$(this);this.useAcomBus=window.acom&&window.acom.bus,this.mediaTypes=["p","rm","s","a","v"],this.typeFilters=[],this.sortType={default:"sortbydateoldest",current:"sortbydateoldest"},this.data={},this.forceText=function(t){return t&&$("<div>").text(t)[0].innerText.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&lsqb;/g,"[").replace(/&rsqb;/g,"]")},this.parse=function(t){var e,r,a=this,l=[];return a.data=t,e=function(e,r){var s,c;if(t.objects&&t.objects.length){for(var d,u={urlParams:t.urlParams,viewerTemplateUrl:e,iivTemplateUrl:r,galleryType:a.galleryType,treeRights:t.treeRights},p=0;p<t.objects.length;p++)"s"===t.objects[p].type?document&&((d=document.createElement("line")).innerHTML=t.objects[p].title,t.objects[p].title=a.forceText(d.innerText)):t.objects[p].title=a.forceText(t.objects[p].title),d=new n(t.objects[p],u),l.push(d.data);t.objects=l,mediaApp&&mediaApp.sorters&&t.objects.sort(mediaApp.sorters[a.sortType.default]),t.isEmptyGallery=!1}else t.isEmptyGallery=!0;t.isEmptyWithFilters=!1,t.canEdit=(e=a.galleryType,r=t.treeRights,"apv"!==e&&r&&r.upload),t.isSelector="selector"===a.galleryType,t.showUploadLink=t.isSelector&&t.canEdit,c=function(){i.trigger("sync")},(s=t)&&s.urlParams?o.getUploadMediaUrl(s.urlParams,"media",function(e){s.mediaUploadLink="".concat(e).concat(t.isSelector?(e.includes("?")?"&":"?")+"attachAsPrimary=true":""),o.getUploadMediaUrl(s.urlParams,"photo",function(t){s.photoUploadLink=t,
o.getUploadMediaUrl(s.urlParams,"story",function(t){s.storyUploadLink=t,o.getStoryCreateUrl(s.urlParams,function(t){s.storyCreationLink=t,c()})})})}):c()},r={url:"",mediaId:"MEDIAID"},o.getViewerUrl(t.urlParams,r.mediaId,function(t){r.url=t;var i={url:"",collectionId:"COLLECTIONID",id:"ID",recordId:"RECORDID"},t={collectionId:i.collectionId,id:i.id,recordId:i.recordId};o.getIIVUrl(t,window.location.href,function(t){i.url=t,e(r,i)})}),a},this.fetch=function(t){t=t||$.noop;var n=a.getParams();return $.extend(n,a.getSettings(this.galleryType)),r.getMediaList(n,function(r){r?(r.urlParams=n,e.parse(r)):(e.data={serviceError:!0,isEmptyGallery:!0},i.trigger("sync")),t()}),this},this.addFilter=function(t){return"all"===t?this.typeFilters=[]:-1===this.typeFilters.indexOf(t)&&this.typeFilters.push(t),this.applyFilters(),this},this.setFilters=function(t){var e=this;return t&&(this.typeFilters=t.filter(function(t){return-1!==e.mediaTypes.indexOf(t)}),this.applyFilters()),this},this.removeFilter=function(t){return this.typeFilters.splice(this.typeFilters.indexOf(t),1),this.applyFilters(),this},this.applyFilters=function(){for(var t=!this.typeFilters.length,e=this.data.objects||[],n=0;n<e.length;n++)e[n].active=t||-1!==this.typeFilters.indexOf(e[n].type);return this.useAcomBus&&acom.bus.emit("Selector::filterItems",e),this.data.isEmptyWithFilters=this.isEmptyWithFilters(),this.data.filterCount=this.typeFilters.length,i.trigger("change"),this},this.deleteMedia=function(e){var i=t(this.data.objects,e);return this.removeItemById(e),r.deleteMedia(this.data.urlParams,e,function(){this.useAcomBus&&i&&"p"===i.type&&acom.bus.emit("Selector::deletePhoto",e)}),this},this.unlinkMedia=function(e){var i=t(this.data.objects,e);return this.removeItemById(e),r.unlinkMedia(this.data.urlParams,e,function(){this.useAcomBus&&i&&"p"===i.type&&acom.bus.emit("Selector::unlinkPhoto",e)}),this},this.removeItemById=function(t){var e=this.data.objects;return this.data.objects.some(function(i,n){if(i.id===t)return e.splice(n,1),!0}),this},this.setItemSelect=function(t,e){return this.data.objects.some(function(i){if(i.id===t)return i.isSelected=e,!0}),this},this.getSelected=function(){return this.data.objects.filter(function(t){if(t.isSelected)return t})},this.isEmptyWithFilters=function(){return!(this.data.objects||[]).some(function(t){return t.active})},this.applySort=function(t){this.sortType.current=t,(this.data.objects||[]).sort(mediaApp.sorters[t]),i.trigger("change")},this.getFilterSortQueryString=function(t){var e=[];this.typeFilters.length&&e.push("filter="+this.typeFilters.join(",")),this.sortType.current!==this.sortType.default&&e.push("sort="+this.sortType.current);var i="";return i=0<e.length?(/\?/.test(t)?"&":"?")+e.join("&"):i}}},{"../lib/mediaservice":8,"../lib/urlmaker":10,"../lib/utility":11,"./galleryitemmodel":12}],14:[function(t,e,i){!function(t){function e(t){return t.trim?t.trim():t.replace(/^\s*|\s*$/g,"")}function i(t,e,i){if(e.charAt(i)==t.charAt(0)){for(var n=1,r=t.length;n<r;n++)if(e.charAt(i+n)!=t.charAt(n))return;return 1}}function n(e,i,r,a){for(var o=[],l=null,s=null,c=r[r.length-1];0<e.length;){if(s=e.shift(),c&&"<"==c.tag&&!(s.tag in g))throw new Error("Illegal content in < super tag.");if(t.tags[s.tag]<=t.tags.$||function(t,e){for(var i=0,n=e.length;i<n;i++)if(e[i].o==t.n)return t.tag="#",!0}(s,a))r.push(s),s.nodes=n(e,s.tag,r,a);else{if("/"==s.tag){if(0===r.length)throw new Error("Closing tag without opener: /"+s.n);if(l=r.pop(),s.n!=l.n&&!function(t,e,i){for(var n=0,r=i.length;n<r;n++)if(i[n].c==t&&i[n].o==e)return!0}(s.n,l.n,a))throw new Error("Nesting error: "+l.n+" vs. "+s.n);return l.end=s.i,o}"\n"==s.tag&&(s.last=0==e.length||"\n"==e[0].tag)}o.push(s)}if(0<r.length)throw new Error("missing closing tag: "+r.pop().n);return o}function r(t){var e,i=[];for(e in t.partials)i.push('"'+a(e)+'":{name:"'+a(t.partials[e].name)+'", '+r(t.partials[e])+"}");return"partials: {"+i.join(",")+"}, subs: "+function(t){var e,i=[];for(e in t)i.push('"'+a(e)+'": function(c,p,t,i) {'+t[e]+"}");return"{ "+i.join(",")+" }"}(t.subs)}function a(t){return t.replace(f,"\\\\").replace(u,'\\"').replace(p,"\\n").replace(h,"\\r").replace(m,"\\u2028").replace(y,"\\u2029")}function o(t){return~t.indexOf(".")?"d":"f"}function l(t,e){var i="<"+(e.prefix||"")+t.n+v++;return e.partials[i]={name:t.n,partials:{}},e.code+='t.b(t.rp("'+a(i)+'",c,p,"'+(t.indent||"")+'"));',i}function s(t,e){e.code+="t.b(t.t(t."+o(t.n)+'("'+a(t.n)+'",c,p,0)));'}function c(t){return"t.b("+t+");"}var d=/\S/,u=/\"/g,p=/\n/g,h=/\r/g,f=/\\/g,m=/\u2028/,y=/\u2029/;t.tags={"#":1,"^":2,"<":3,$:4,"/":5,"!":6,">":7,"=":8,_v:9,"{":10,"&":11,_t:12},t.scan=function(n,r){function a(){0<g.length&&(v.push({tag:"_t",text:new String(g)}),g="")}function o(e,i){if(a(),e&&function(){for(var e=!0,i=k;i<v.length;i++)if(!(e=t.tags[v[i].tag]<t.tags._v||"_t"==v[i].tag&&null===v[i].text.match(d)))return;return e}())for(var n,r=k;r<v.length;r++)v[r].text&&((n=v[r+1])&&">"==n.tag&&(n.indent=v[r].text.toString()),v.splice(r,1));else i||v.push({tag:"\n"});b=!1,k=v.length}var l,s,c,u,p,h,f=n.length,m=0,y=null,g="",v=[],b=!1,w=0,k=0,U="{{",C="}}";for(r&&(r=r.split(" "),U=r[0],C=r[1]),w=0;w<f;w++)0==m?i(U,n,w)?(--w,a(),m=1):"\n"==n.charAt(w)?o(b):g+=n.charAt(w):1==m?(w+=U.length-1,m="="==(y=(l=t.tags[n.charAt(w+1)])?n.charAt(w+1):"_v")?(u=w,h=p=void 0,p="="+C,h=(c=n).indexOf(p,u),u=e(c.substring(c.indexOf("=",u)+1,h)).split(" "),U=u[0],C=u[u.length-1],w=h+p.length-1,0):(l&&w++,2),b=w):i(C,n,w)?(v.push({tag:y,n:e(g),otag:U,ctag:C,i:"/"==y?b-U.length:w+C.length}),g="",w+=C.length-1,m=0,"{"==y&&("}}"==C?w++:"}"===(s=v[v.length-1]).n.substr(s.n.length-1)&&(s.n=s.n.substring(0,s.n.length-1)))):g+=n.charAt(w);return o(b,!0),v};var g={_t:!0,"\n":!0,$:!0,"/":!0};t.stringify=function(e,i,n){return"{code: function (c,p,i) { "+t.wrapMain(e.code)+" },"+r(e)+"}"};var v=0;t.generate=function(e,i,n){v=0;var r={code:"",subs:{},partials:{}};return t.walk(e,r),n.asString?this.stringify(r,i,n):this.makeTemplate(r,i,n)},t.wrapMain=function(t){return'var t=this;t.b(i=i||"");'+t+"return t.fl();"},t.template=t.Template,t.makeTemplate=function(t,e,i){var n=this.makePartials(t);return n.code=new Function("c","p","i",this.wrapMain(t.code)),new this.template(n,e,this,i)},t.makePartials=function(t){var e,i={subs:{},partials:t.partials,name:t.name};for(e in i.partials)i.partials[e]=this.makePartials(i.partials[e]);for(e in t.subs)i.subs[e]=new Function("c","p","t","i",t.subs[e]);return i},t.codegen={"#":function(e,i){i.code+="if(t.s(t."+o(e.n)+'("'+a(e.n)+'",c,p,1),c,p,0,'+e.i+","+e.end+',"'+e.otag+" "+e.ctag+'")){t.rs(c,p,function(c,p,t){',t.walk(e.nodes,i),i.code+="});c.pop();}"},"^":function(e,i){i.code+="if(!t.s(t."+o(e.n)+'("'+a(e.n)+'",c,p,1),c,p,1,0,0,"")){',t.walk(e.nodes,i),i.code+="};"},">":l,"<":function(e,i){var n={partials:{},code:"",subs:{},inPartial:!0};t.walk(e.nodes,n),i=i.partials[l(e,i)],i.subs=n.subs,i.partials=n.partials},$:function(e,i){var n={subs:{},code:"",partials:i.partials,prefix:e.n};t.walk(e.nodes,n),i.subs[e.n]=n.code,i.inPartial||(i.code+='t.sub("'+a(e.n)+'",c,p,i);')},"\n":function(t,e){e.code+=c('"\\n"'+(t.last?"":" + i"))},_v:function(t,e){e.code+="t.b(t.v(t."+o(t.n)+'("'+a(t.n)+'",c,p,0)));'},_t:function(t,e){e.code+=c('"'+a(t.text)+'"')},"{":s,"&":s},t.walk=function(e,i){for(var n,r=0,a=e.length;r<a;r++)(n=t.codegen[e[r].tag])&&n(e[r],i);return i},t.parse=function(t,e,i){return n(t,0,[],(i=i||{}).sectionTags||[])},t.cache={},t.cacheKey=function(t,e){return[t,!!e.asString,!!e.disableLambda,e.delimiters,!!e.modelGet].join("||")},t.compile=function(e,i){var n=t.cacheKey(e,i=i||{}),r=this.cache[n];if(r){var a,o=r.partials;for(a in o)delete o[a].instance;return r}return r=this.generate(this.parse(this.scan(e,i.delimiters),e,i),e,i),this.cache[n]=r}}(void 0!==i?i:Hogan)},{}],15:[function(t,e,i){var n=t("./compiler");n.Template=t("./template").Template,n.template=n.Template,e.exports=n},{"./compiler":14,"./template":16}],16:[function(t,e,i){!function(t){function e(t,e,i){var n;return e&&"object"==_typeof(e)&&(void 0!==e[t]?n=e[t]:i&&e.get&&"function"==typeof e.get&&(n=e.get(t))),n}function i(t){return String(null==t?"":t)}t.Template=function(t,e,i,n){this.r=(t=t||{}).code||this.r,this.c=i,this.options=n||{},this.text=e||"",this.partials=t.partials||{},this.subs=t.subs||{},this.buf=""},t.Template.prototype={r:function(t,e,i){return""},v:function(t){return t=i(t),s.test(t)?t.replace(n,"&amp;").replace(r,"&lt;").replace(a,"&gt;").replace(o,"&#39;").replace(l,"&quot;"):t},t:i,render:function(t,e,i){return this.ri([t],e||{},i)},ri:function(t,e,i){return this.r(t,e,i)},ep:function(t,e){var i=this.partials[t],n=e[i.name];if(i.instance&&i.base==n)return i.instance;if("string"==typeof n){if(!this.c)throw new Error("No compiler available.");n=this.c.compile(n,this.options)}if(!n)return null;if(this.partials[t].base=n,i.subs){for(key in e.stackText||(e.stackText={}),i.subs)e.stackText[key]||(e.stackText[key]=void 0!==this.activeSub&&e.stackText[this.activeSub]?e.stackText[this.activeSub]:this.text);n=function(t,e,i,n,r,a){function o(){}function l(){}l.prototype=(o.prototype=t).subs;var s=new o;for(var c in s.subs=new l,s.subsText={},s.buf="",n=n||{},s.stackSubs=n,s.subsText=a,e)n[c]||(n[c]=e[c]);for(c in n)s.subs[c]=n[c];for(c in r=r||{},s.stackPartials=r,i)r[c]||(r[c]=i[c]);for(c in r)s.partials[c]=r[c];return s}(n,i.subs,i.partials,this.stackSubs,this.stackPartials,e.stackText)}return this.partials[t].instance=n},rp:function(t,e,i,n){return t=this.ep(t,i),t?t.ri(e,i,n):""},rs:function(t,e,i){var n=t[t.length-1];if(c(n))for(var r=0;r<n.length;r++)t.push(n[r]),i(t,e,this),t.pop();else i(t,e,this)},s:function(t,e,i,n,r,a,o){return(!c(t)||0!==t.length)&&(o=!!(t="function"==typeof t?this.ms(t,e,i,n,r,a,o):t),!n&&o&&e&&e.push("object"==_typeof(t)?t:e[e.length-1]),o)},d:function(t,i,n,r){var a,o=t.split("."),l=this.f(o[0],i,n,r),s=this.options.modelGet,d=null;if("."===t&&c(i[i.length-2]))l=i[i.length-1];else for(var u=1;u<o.length;u++)l=void 0!==(a=e(o[u],l,s))?(d=l,a):"";return!(r&&!l)&&(r||"function"!=typeof l||(i.push(d),l=this.mv(l,i,n),i.pop()),l)},f:function(t,i,n,r){for(var a=!1,o=!1,l=this.options.modelGet,s=i.length-1;0<=s;s--)if(void 0!==(a=e(t,i[s],l))){o=!0;break}return o?r||"function"!=typeof a?a:this.mv(a,i,n):!r&&""},ls:function(t,e,n,r,a){var o=this.options.delimiters;return this.options.delimiters=a,this.b(this.ct(i(t.call(e,r)),e,n)),this.options.delimiters=o,!1},ct:function(t,e,i){if(this.options.disableLambda)throw new Error("Lambda features disabled.");return this.c.compile(t,this.options).render(e,i)},b:function(t){this.buf+=t},fl:function(){var t=this.buf;return this.buf="",t},ms:function(t,e,i,n,r,a,o){return e=e[e.length-1],t=t.call(e),"function"==typeof t?!!n||(n=this.activeSub&&this.subsText&&this.subsText[this.activeSub]?this.subsText[this.activeSub]:this.text,this.ls(t,e,i,n.substring(r,a),o)):t},mv:function(t,e,n){return e=e[e.length-1],t=t.call(e),"function"==typeof t?this.ct(i(t.call(e)),e,n):t},sub:function(t,e,i,n){var r=this.subs[t];r&&(this.activeSub=t,r(e,i,this,n),this.activeSub=!1)}};var n=/&/g,r=/</g,a=/>/g,o=/\'/g,l=/\"/g,s=/[&<>\"\']/,c=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}}(void 0!==i?i:{})},{}]},{},[2]);
//# sourceMappingURL=js-gallery-bundle-864394a4.min.js.map